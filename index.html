<!DOCTYPE html>
<html>
 <head>
 	<meta charset="UTF-8" />
 	<meta name="viewport" content="width=device-width, user-scalable=no">
 	<title>Aarrejahti</title>
 	<link rel="stylesheet" href="css/jquery.mobile-1.4.0.min.css" type="text/css">
 	<script type="text/javascript" src="js/jquery.js"></script>
 	<script type="text/javascript" src="js/app.js"></script>
    <script type="text/javascript">
    $(document).on("mobileinit", function(){
        $.mobile.defaultPageTransition = 'flip';
    });
    </script>
 	<script type="text/javascript" src="js/jquery.mobile-1.4.0.min.js"></script>
 	<script type="text/javascript" src="cordova.js"></script>
 	<link rel="stylesheet" href="css/app.css" type="text/css">
    <link rel="stylesheet" href="css/treasurehunt.min.css" type="text/css">
    <link rel="stylesheet" href="css/jquery.mobile.icons.min.css" type="text/css">

    <script type="text/javascript">
    var jsonURL = "http://satutyrvainen.com/treasurehunt/campaigns.json";
    // Aarteen sijainti (Veturitallinkatu 5 as. 626, 40100 Jyväskylä)
    treasureLat = 0; //62.2432626  &&  62.2435172 tarpeeksi lähekkäin
    treasureLon = 0;  // 25.7580648  &&  25.7577094 tarpeeksi lähekkäin

    watchID = null;
    treasureDistance = 999;

    // Wait for device API libraries to load
    //
    document.addEventListener("deviceready", onDeviceReady, false);
    // device APIs are available
    //
    function onDeviceReady() {
        $( document ).delegate(".treasurehunt", "pageinit", function() {
            findLocation();  

            $('.relocate').click(function(){
                findLocation();
            });
        });

    }

    // Funktio, joka tarkkaillee käyttäjän sijaintia ja päivittää käyttäjän sijainnin longituden ja latituden tarvittaessa
    function findLocation() {
        //document.getElementById('geolocation').innerHTML = 'Etsitään sijaintia...';

        // Throw an error if no update is received every 5 seconds
        var options = {maximumAge: 0, timeout: 5000, enableHighAccuracy:true};
        watchID = navigator.geolocation.watchPosition(onSuccess, onError, options);
    }



    // onSuccess Geolocation
    function onSuccess(position) {
        var currentHuntID = $.mobile.activePage.attr("id");
        treasureLat = parseFloat($('input#'+currentHuntID+'lat').val());
        treasureLon = parseFloat($('input#'+currentHuntID+'lon').val());    
        var element = document.getElementById(currentHuntID+'geolocation');
        var coldWarm = document.getElementById(currentHuntID+'checkedLocation');
        var displat = document.getElementById(currentHuntID+'latval');
        var displon = document.getElementById(currentHuntID+'lonval');
        var nextStepBtn = $('#'+currentHuntID).children('.content').children('#tonextstep');
        var lastStepBtn = $('#'+currentHuntID).children('.content').children('#tolaststep');
        var treasureCode = ($('input#'+currentHuntID+'code').val()).toLowerCase();
        console.log("KOODI: " + treasureCode);
        var currentTreasureDistance = 999;

        // The user's current Lat and Long
        var userLat = parseFloat(position.coords.latitude);
        var userLon = parseFloat(position.coords.longitude);

        displat.innerHTML = userLat;
        displon.innerHTML = userLon;

        currentTreasureDistance = ( (treasureLat + treasureLon) - (userLat + userLon) );

        // The current distance to the treasure from user's current location [(treasure long + lat) - (current long + lat)]
        if ( currentTreasureDistance < 0 ) {
            currentTreasureDistance = ( currentTreasureDistance * (-1) );
        }
        else {
            currentTreasureDistance = currentTreasureDistance;
        }

        //console.log('treasureDistance: ' + treasureDistance + ' currentTreasureDistance: ' + currentTreasureDistance);  
        //console.log('treasureDistance - currentTreasureDistance : ' + (treasureDistance-currentTreasureDistance));  

        console.log('treasureLat - userLat: ' + (treasureLat - userLat) + ' ja treasureLon - userLon: ' + (treasureLon - userLon));

        if ( ( (treasureLat - userLat <= 0.0009 ) && (treasureLat - userLat >= -0.0009) ) &&
            ( (treasureLon - userLon <= 0.0009 ) && (treasureLon - userLon >= -0.0009) ) ) {
                element.innerHTML = 'Olet lähellä aarretta!';
                lastStepBtn.css('display', 'block');
                nextStepBtn.css('display', 'block');
                //showAlert();
                //navigator.geolocation.clearWatch(watchID);
        }
        else if ( ( (treasureLat - userLat <= 0.002 ) && (treasureLat - userLat >= -0.002) ) &&
            ( (treasureLon - userLon <= 0.002 ) && (treasureLon - userLon >= -0.002) ) ) {
                element.innerHTML = 'Olet melko lähellä aarretta';
                nextStepBtn.css('display', 'block');
        }
        else if ( ( (treasureLat - userLat <= 0.005 ) && (treasureLat - userLat >= -0.005) ) &&
            ( (treasureLon - userLon <= 0.005 ) && (treasureLon - userLon >= -0.005) ) ) {
                element.innerHTML = 'Olet vielä melko kaukana aarteesta';
        }
        else {
            element.innerHTML = 'Et ole lähellä aarretta, etsiskelehän vielä';
        }


        if ( (treasureDistance >= currentTreasureDistance) && ( (currentTreasureDistance <= 0.0003) ) ) {
            coldWarm.innerHTML = 'Polttaa';
        }        
        else if (treasureDistance > currentTreasureDistance) {
            coldWarm.innerHTML = 'Lämpenee';
        }
        else if (treasureDistance < currentTreasureDistance) {
            coldWarm.innerHTML = 'Kylmenee';
        }
        else if (treasureDistance == currentTreasureDistance) {
            coldWarm.innerHTML = 'Ei kylmene eikä lämpene';       
        }

        treasureDistance = currentTreasureDistance;

        var form = document.getElementById(currentHuntID+'form');
        var submit = document.getElementById(currentHuntID+'submit');

        $(form).on("submit",function(e) {
            //disable the button so we can't resubmit while we wait
            //$(submit,form).attr("disabled","disabled");

            navigator.geolocation.clearWatch(watchID);

            var code = ($("#code", this).val()).toLowerCase();

            if (code == treasureCode) {
                console.log("jee!");
            }
            else {
                console.log("eieiei");
            }
        });

    }



    // onError Callback receives a PositionError object
    function onError(error) {
        alert('Tapahtui virhe.' + '\n' + 'Koodi: '    + error.code    + '\n' +
              'Viesti: ' + error.message + '\n');
    }

    // Jos käyttäjä on aarteen lähellä, näytetään notifikaatio
    function showAlert() {
        navigator.notification.alert(
            'Olet aivan aarteen lähellä!',  // message
            'Polttaa polttaa!',            // title
            'OK'                  // buttonName
        );
    }

    </script>

 </head>
 <body>
<div id="wrapper">
    <!-- ****** ETUSIVU ****** -->
 	<div data-role="page" id="home">
 		<div data-role="header" data-position="fixed">
 			<h1>Aarrejahti</h1>
 		</div>
 		<div data-role="content" class="content">
            <div class="logo-holder centerme">
                <img src="images/logo.png">
            </div>
            <h2>Tervetuloa Aarrejahtiin!</h2>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce molestie blandit tellus. Vivamus cursus, lorem ut pellentesque bibendum, est elit pharetra tellus, lacinia tempus neque arcu eget urna. Aenean sed quam eget ipsum hendrerit molestie. Aliquam tempor diam at elementum fermentum.</p>

            <ul data-role="listview" data-inset="true">
                <li><a href="#campaigns">Kampanjat</a></li>
                <li><a href="#termsofuse">Käyttöehdot</a></li>
                <li><a href="#info">Tietoja</a></li>
            </ul>
            
 		</div>
 		<div data-role="footer" data-position="fixed">
            <div class="ui-grid-a">
                <div class="ui-block-a">
                    <a href="#home" data-role="button" data-icon="home" data-iconpos="notext" data-theme="a" data-inline="true">Home</a>
                </div>
                <div class="ui-block-b">
                    <a href="#" data-role="button" data-icon="back" data-iconpos="notext" data-theme="a" data-inline="true">Back</a>
                </div>
            </div>
 		</div>
 	</div>


    <!-- **** KAMPANJAT **** -->
    <div data-role="page" id="campaigns">
        <div data-role="header" data-position="fixed">
            <h1>Aarrejahti</h1>
        </div>
        <div data-role="content" class="content">

            <h2>Käynnissä olevat kampanjat</h2>
            <p>
                Valitse aarrejahti, johon haluat osallistua
            </p>

            <!-- JAVASCRIPT -->
            <ul data-role="listview" data-inset="true" id="campaignList">
            <script type="text/javascript">
                // Parsing JSON data with jQuery
                var output = "";
                $.getJSON(jsonURL,function(json){
                    $.each(json.campaigns,function(i,campaigns){
                        output += "<li><a href='#" + json.campaigns[i].campaignID + "'>"
                        + json.campaigns[i].campaignName + "</a></li>";
                    });
                    var outputTarget = document.getElementById("campaignList");
                    outputTarget.innerHTML=output;
                });
            </script>
            </ul>

            
        </div>
        <div data-role="footer" data-position="fixed">
            <div class="ui-grid-a">
                <div class="ui-block-a">
                    <a href="#home" data-role="button" data-icon="home" data-iconpos="notext" data-theme="a" data-inline="true">Home</a>
                </div>
                <div class="ui-block-b">
                    <a href="#" data-role="button" data-rel="back" data-icon="back" data-iconpos="notext" data-theme="a" data-inline="true">Back</a>
                </div>
            </div>
        </div>
    </div>



    <!-- ** LUODAAN KAMPANJA(T) ** -->
    <script type="text/javascript">
        // Parsing JSON data with jQuery
        var campaignViewOutput = "";
        $.getJSON(jsonURL,function(json){
            $.each(json.campaigns,function(i,campaigns){
                campaignViewOutput += "<div data-role=" + "page" + " id=" + json.campaigns[i].campaignID + ">"
                + "<div data-role='header' data-position='fixed'>";
                campaignViewOutput += "<h1>Aarrejahti</h1>";
                campaignViewOutput += "</div>";

                campaignViewOutput += "<div data-role='content' class='content'>";
                campaignViewOutput += "<h2>" + json.campaigns[i].campaignName + "</h2>";
                campaignViewOutput += "<p>" + json.campaigns[i].campaignDescription + "</p>";

                campaignViewOutput += "<h2>Aarrejahdit</h2>";
                campaignViewOutput += "<ul data-role='listview' data-inset='true'>";
                $.each(campaigns.treasurehunts, function(j, treasurehunts) {
                    if ( parseInt(treasurehunts.treasurehuntStatus) == 0) {
                        campaignViewOutput += "<li><a href='#" + treasurehunts.treasurehuntID + "'>"
                                            + treasurehunts.treasurehuntName + "</a></li>";
                    }
                });
                campaignViewOutput += "</ul>";

                campaignViewOutput += "<div data-role='footer' data-position='fixed'>"+
                                    "<div class='ui-grid-a'>"+
                                    "<div class='ui-block-a'>"+
                                    "<a href='#home' data-role='button' data-icon='home' data-iconpos='notext' data-theme='a' data-inline='true'>Home</a>"+
                                    "</div>"+
                                    "<div class='ui-block-b'>"+
                                    "<a href='#' data-role='button' data-rel='back' data-icon='back' data-iconpos='notext' data-theme='a' data-inline='true'>Back</a>"+
                                    "</div></div></div></div></div>";
                });
            
            var newCampaign = $(campaignViewOutput);
            newCampaign.appendTo($.mobile.pageContainer);

            /*
            var campaignsHolder = document.getElementById("wrapper");
            campaignsHolder.innerHTML += campaignViewOutput;
            */
        });
    </script>


<!-- ** YKSITTÄINEN KAMPANJA (alkuperäinen koodi) ** -->
<!--
    <div data-role="page" id="campaign01">
        <div data-role="header" data-position="fixed">
            <h1>Aarrejahti</h1>
        </div>
        <div data-role="content" class="content">

            <h2>Kampanjan nimi</h2>
            <p>
                Lyhyt kuvaus itse kampanjasta, palkinnoista, osallistumisajasta jne... Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce molestie blandit tellus. Vivamus cursus, lorem ut pellentesque bibendum, est elit pharetra tellus, lacinia tempus neque arcu eget urna. Aenean sed quam eget ipsum hendrerit molestie.
            </p>

            <h2>Aarrejahdit</h2>

            <ul data-role="listview" data-inset="true">
                <li data-role="list-divider" data-theme="a">Käynnissä</li>
                <li><a href="#campaign01treasure01">Käynnissä oleva aarrejahti 07.01.2014</a></li>
                <li data-role="list-divider" data-theme="a">Menneet</li>
                <li><a href="#">Mennyt aarrejahti 01.01.2014</a></li>
            </ul>
            
        </div>
        <div data-role="footer" data-position="fixed">
            <div class="ui-grid-a">
                <div class="ui-block-a">
                    <a href="#home" data-role="button" data-icon="home" data-iconpos="notext" data-theme="a" data-inline="true">Home</a>
                </div>
                <div class="ui-block-b">
                    <a href="#" data-role="button" data-rel="back" data-icon="back" data-iconpos="notext" data-theme="a" data-inline="true">Back</a>
                </div>
            </div>
        </div>
    </div>
-->



    <!-- ** LUODAAN KAMPANJAN AARREJAHTI ** -->

    <script type="text/javascript">
    // Parsing JSON data with jQuery
    var treasurehuntViewOutput = "";

    $.getJSON(jsonURL,function(json){
        $.each(json.campaigns,function(i,campaigns){
            $.each(campaigns.treasurehunts, function(j, treasurehunts) {
                console.log(parseInt(treasurehunts.treasurehuntStatus));
                if ( parseInt(treasurehunts.treasurehuntStatus) == 0) {
                    treasurehuntViewOutput += "<div data-role=" + "page" + " id=" + treasurehunts.treasurehuntID + " class='treasurehunt " + treasurehunts.treasurehuntID + "'>"
                    + "<div data-role='header' data-position='fixed'>";
                    treasurehuntViewOutput += "<h1>Aarrejahti</h1>";
                    treasurehuntViewOutput += "</div>";

                    treasurehuntViewOutput += "<div data-role='content' class='content'>";
                    treasurehuntViewOutput += "<p id='"+treasurehunts.treasurehuntID+"geolocation' class='geolocation'>Etsitään sijaintia...</p>";
                    treasurehuntViewOutput += "<div class='hint-image centerme'>";
                    treasurehuntViewOutput += "<img src='" + treasurehunts.treasurehuntStep1 + "'></div>";

                    treasurehuntViewOutput += "<div class='ui-grid-a'>";
                    treasurehuntViewOutput += "<div class='ui-block-a'><span class='highlight'>Latitude:</span></div>";
                    treasurehuntViewOutput += "<div class='ui-block-b'><span id='"+treasurehunts.treasurehuntID+"latval'>?</span></div></div>";

                    treasurehuntViewOutput += "<div class='ui-grid-a'>";
                    treasurehuntViewOutput += "<div class='ui-block-a'><span class='highlight'>Longitude:</span></div>";
                    treasurehuntViewOutput += "<div class='ui-block-b'><span id='"+treasurehunts.treasurehuntID+"lonval'>?</span></div></div>"

                    treasurehuntViewOutput += "<br><br><p id='"+treasurehunts.treasurehuntID+"checkedLocation' class='checkedLocation'></p>";
                    treasurehuntViewOutput += "<a href='#"+treasurehunts.treasurehuntID+"step2' data-role='button' id='tonextstep' class='tonextstep'>Seuraava vaihe!</a>";
                    treasurehuntViewOutput += "<button id='relocate' class='relocate'>Tarkista sijainti</button></div>";

                    // Hidden inputs for treasurehunt spesific parameters such as longitude and latitude of the treasure and current hunts id
                    treasurehuntViewOutput += "<input type='hidden' name='huntID' id='huntID' value='" + treasurehunts.treasurehuntID + "'>";
                    treasurehuntViewOutput += "<input type='hidden' name='huntCode' id='"+ treasurehunts.treasurehuntID + "code' value='" + treasurehunts.treasurehuntCode + "'>";
                    treasurehuntViewOutput += "<input type='hidden' name='latitude' id='"+ treasurehunts.treasurehuntID + "lat' value='" + treasurehunts.treasurehuntLat + "'>";
                    treasurehuntViewOutput += "<input type='hidden' name='longitude' id='"+ treasurehunts.treasurehuntID + "lon' value='" + treasurehunts.treasurehuntLon + "'>";
                    /*
                    treasurehuntViewOutput += "treasureLat = " + treasurehunts.treasurehuntLat + ";";
                    treasurehuntViewOutput += "treasureLon = " + treasurehunts.treasurehuntLon + ";";
                    treasurehuntViewOutput += "var watchID = null;";
                    treasurehuntViewOutput += "var treasureDistance = 999;";
                    treasurehuntViewOutput += "document.addEventListener('deviceready', onDeviceReady, false);";
                    treasurehuntViewOutput += "function onDeviceReady() {";
                    treasurehuntViewOutput += "$( document ).delegate('#" + treasurehunts.treasurehuntID + "', 'pageinit', function() {";
                    treasurehuntViewOutput += "findLocation();});}";
                    treasurehuntViewOutput += humppasusi;
                    */


                    treasurehuntViewOutput += "<div data-role='footer' data-position='fixed'>"+
                                "<div class='ui-grid-a'>"+
                                    "<div class='ui-block-a'>"+
                                        "<a href='#home' data-role='button' data-icon='home' data-iconpos='notext' data-theme='a' data-inline='true'>Home</a>"+
                                    "</div>"+
                                    "<div class='ui-block-b'>"+
                                        "<a href='#' data-role='button' data-rel='back' data-icon='back' data-iconpos='notext' data-theme='a' data-inline='true'>Back</a>"+
                                    "</div></div></div></div></div>";
                }

            });

        });

        var newTreasurehunt = $(treasurehuntViewOutput);
        newTreasurehunt.appendTo($.mobile.pageContainer);

    });
    </script>


    <!-- ** LUODAAN KAMPANJAN AARREJAHDIN 2. VAIHE ** -->

    <script type="text/javascript">
    // Parsing JSON data with jQuery
    var treasurehuntStep2ViewOutput = "";

    $.getJSON(jsonURL,function(json){
        $.each(json.campaigns,function(i,campaigns){
            $.each(campaigns.treasurehunts, function(j, treasurehunts) {
                if ( parseInt(treasurehunts.treasurehuntStatus) == 0) {
                    treasurehuntStep2ViewOutput += "<div data-role=" + "page" + " id='" + treasurehunts.treasurehuntID + "step2' class='treasurehunt " + treasurehunts.treasurehuntID + "step2'>"
                    + "<div data-role='header' data-position='fixed'>";
                    treasurehuntStep2ViewOutput += "<h1>Aarrejahti</h1>";
                    treasurehuntStep2ViewOutput += "</div>";

                    treasurehuntStep2ViewOutput += "<div data-role='content' class='content'>";
                    treasurehuntStep2ViewOutput += "<p id='"+treasurehunts.treasurehuntID+"step2geolocation' class='geolocation'>Etsitään sijaintia...</p>";
                    treasurehuntStep2ViewOutput += "<div class='hint-image centerme'>";
                    treasurehuntStep2ViewOutput += "<img src='" + treasurehunts.treasurehuntStep2 + "'></div>";

                    treasurehuntStep2ViewOutput += "<div class='ui-grid-a'>";
                    treasurehuntStep2ViewOutput += "<div class='ui-block-a'><span class='highlight'>Latitude:</span></div>";
                    treasurehuntStep2ViewOutput += "<div class='ui-block-b'><span id='"+treasurehunts.treasurehuntID+"step2latval'>?</span></div></div>";

                    treasurehuntStep2ViewOutput += "<div class='ui-grid-a'>";
                    treasurehuntStep2ViewOutput += "<div class='ui-block-a'><span class='highlight'>Longitude:</span></div>";
                    treasurehuntStep2ViewOutput += "<div class='ui-block-b'><span id='"+treasurehunts.treasurehuntID+"step2lonval'>?</span></div></div>"

                    treasurehuntStep2ViewOutput += "<br><br><p id='"+treasurehunts.treasurehuntID+"step2checkedLocation' class='checkedLocation'></p>";
                    treasurehuntStep2ViewOutput += "<a href='#"+treasurehunts.treasurehuntID+"step3' data-role='button' id='tolaststep' class='tolaststep'>Seuraava vaihe!</a>";
                    treasurehuntStep2ViewOutput += "<button id='relocate' class='relocate'>Tarkista sijainti</button></div>";

                    // Hidden inputs for treasurehunt spesific parameters such as longitude and latitude
                    treasurehuntStep2ViewOutput += "<input type='hidden' name='huntID' id='huntID' value='" + treasurehunts.treasurehuntID + "step2'>";
                    treasurehuntStep2ViewOutput += "<input type='hidden' name='huntCode' id='"+ treasurehunts.treasurehuntID + "step2code' value='" + treasurehunts.treasurehuntCode + "'>";
                    treasurehuntStep2ViewOutput += "<input type='hidden' name='latitude' id='"+ treasurehunts.treasurehuntID + "step2lat' value='" + treasurehunts.treasurehuntLat + "'>";
                    treasurehuntStep2ViewOutput += "<input type='hidden' name='longitude' id='"+ treasurehunts.treasurehuntID + "step2lon' value='" + treasurehunts.treasurehuntLon + "'>";
                    /*
                    treasurehuntStep2ViewOutput += "treasureLat = " + treasurehunts.treasurehuntLat + ";";
                    treasurehuntStep2ViewOutput += "treasureLon = " + treasurehunts.treasurehuntLon + ";";
                    treasurehuntStep2ViewOutput += "var watchID = null;";
                    treasurehuntStep2ViewOutput += "var treasureDistance = 999;";
                    treasurehuntStep2ViewOutput += "document.addEventListener('deviceready', onDeviceReady, false);";
                    treasurehuntStep2ViewOutput += "function onDeviceReady() {";
                    treasurehuntStep2ViewOutput += "$( document ).delegate('#" + treasurehunts.treasurehuntID + "', 'pageinit', function() {";
                    treasurehuntStep2ViewOutput += "findLocation();});}";
                    treasurehuntStep2ViewOutput += humppasusi;
                    */


                    treasurehuntStep2ViewOutput += "<div data-role='footer' data-position='fixed'>"+
                                "<div class='ui-grid-a'>"+
                                    "<div class='ui-block-a'>"+
                                        "<a href='#home' data-role='button' data-icon='home' data-iconpos='notext' data-theme='a' data-inline='true'>Home</a>"+
                                    "</div>"+
                                    "<div class='ui-block-b'>"+
                                        "<a href='#' data-role='button' data-rel='back' data-icon='back' data-iconpos='notext' data-theme='a' data-inline='true'>Back</a>"+
                                    "</div></div></div></div></div>";
                }

            });

        });

        var newTreasurehuntStep2 = $(treasurehuntStep2ViewOutput);
        newTreasurehuntStep2.appendTo($.mobile.pageContainer);

    });
    </script>




    <!-- ** LUODAAN KAMPANJAN AARREJAHDIN 3. VAIHE ** -->

    <script type="text/javascript">
    // Parsing JSON data with jQuery
    var treasurehuntStep3ViewOutput = "";

    $.getJSON(jsonURL,function(json){
        $.each(json.campaigns,function(i,campaigns){
            $.each(campaigns.treasurehunts, function(j, treasurehunts) {
                if ( parseInt(treasurehunts.treasurehuntStatus) == 0) {
                    treasurehuntStep3ViewOutput += "<div data-role=" + "page" + " id='" + treasurehunts.treasurehuntID + "step3' class='treasurehunt " + treasurehunts.treasurehuntID + "step2'>"
                    + "<div data-role='header' data-position='fixed'>";
                    treasurehuntStep3ViewOutput += "<h1>Aarrejahti</h1>";
                    treasurehuntStep3ViewOutput += "</div>";

                    treasurehuntStep3ViewOutput += "<div data-role='content' class='content'>";
                    treasurehuntStep3ViewOutput += "<h2>Olet aivan aarteen lähellä!</h2>";
                    treasurehuntStep3ViewOutput += "<p>Syötä yhteystietosi ja aarteen koodi alla olevaan lomakkeeseen</p>";

                    treasurehuntStep3ViewOutput += "<form id='" + treasurehunts.treasurehuntID + "form'>";
                    treasurehuntStep3ViewOutput += "<div data-role='fieldcontain'>";
                    treasurehuntStep3ViewOutput += "<label for='name'>Nimi:</label>";
                    treasurehuntStep3ViewOutput += "<input type='text' name='name' id='name'>";
                    treasurehuntStep3ViewOutput += "<label for='address'>Osoite:</label>";
                    treasurehuntStep3ViewOutput += "<input type='text' name='address' id='address'>";
                    treasurehuntStep3ViewOutput += "<label for='zipcode'>Postinumero:</label>";
                    treasurehuntStep3ViewOutput += "<input type='text' name='zipcode' id='zipcode'>";
                    treasurehuntStep3ViewOutput += "<label for='city'>Toimipaikka:</label>";
                    treasurehuntStep3ViewOutput += "<input type='text' name='city' id='city'>";
                    treasurehuntStep3ViewOutput += "<label for='code'>Koodi:</label>";
                    treasurehuntStep3ViewOutput += "<input type='text' name='code' id='code'>";
                    treasurehuntStep3ViewOutput += "</div>";
                    treasurehuntStep3ViewOutput += "<input type='submit' id='" + treasurehunts.treasurehuntID + "submit' data-inline='true' data-role='button' data-theme='a' value='Lähetä'>";
                    treasurehuntStep3ViewOutput += "</form>";

                    // Hidden inputs for treasurehunt spesific parameters such as longitude and latitude
                    treasurehuntStep3ViewOutput += "<input type='hidden' name='huntID' id='huntID' value='" + treasurehunts.treasurehuntID + "step3'>";
                    treasurehuntStep3ViewOutput += "<input type='hidden' name='huntCode' id='"+ treasurehunts.treasurehuntID + "step3code' value='" + treasurehunts.treasurehuntCode + "'>";
                    treasurehuntStep3ViewOutput += "<input type='hidden' name='latitude' id='"+ treasurehunts.treasurehuntID + "step3lat' value='" + treasurehunts.treasurehuntLat + "'>";
                    treasurehuntStep3ViewOutput += "<input type='hidden' name='longitude' id='"+ treasurehunts.treasurehuntID + "step3lon' value='" + treasurehunts.treasurehuntLon + "'>";
                    /*
                    treasurehuntStep3ViewOutput += "treasureLat = " + treasurehunts.treasurehuntLat + ";";
                    treasurehuntStep3ViewOutput += "treasureLon = " + treasurehunts.treasurehuntLon + ";";
                    treasurehuntStep3ViewOutput += "var watchID = null;";
                    treasurehuntStep3ViewOutput += "var treasureDistance = 999;";
                    treasurehuntStep3ViewOutput += "document.addEventListener('deviceready', onDeviceReady, false);";
                    treasurehuntStep3ViewOutput += "function onDeviceReady() {";
                    treasurehuntStep3ViewOutput += "$( document ).delegate('#" + treasurehunts.treasurehuntID + "', 'pageinit', function() {";
                    treasurehuntStep3ViewOutput += "findLocation();});}";
                    treasurehuntStep3ViewOutput += humppasusi;
                    */


                    treasurehuntStep3ViewOutput += "<div data-role='footer' data-position='fixed'>"+
                                "<div class='ui-grid-a'>"+
                                    "<div class='ui-block-a'>"+
                                        "<a href='#home' data-role='button' data-icon='home' data-iconpos='notext' data-theme='a' data-inline='true'>Home</a>"+
                                    "</div>"+
                                    "<div class='ui-block-b'>"+
                                        "<a href='#' data-role='button' data-rel='back' data-icon='back' data-iconpos='notext' data-theme='a' data-inline='true'>Back</a>"+
                                    "</div></div></div></div></div>";
                }

            });

        });

        var newTreasurehuntStep3 = $(treasurehuntStep3ViewOutput);
        newTreasurehuntStep3.appendTo($.mobile.pageContainer);

    });
    </script>


    <!-- ** YKSITTÄISEN KAMPANJAN KÄYNNISSÄ OLEVA AARREJAHTI (alkuperäinen koodi) ** -->
    <!--
    <div data-role="page" id="campaign01treasurehunt01">
        <div data-role="header" data-position="fixed">
            <h1>Aarrejahti</h1>
        </div>
        <div data-role="content" class="content">

            <p id="geolocation">Etsitään sijaintia...</p>

            <div class="hint-image centerme">
                <img src="images/vihjekuva.jpg">
            </div>

            <div class="ui-grid-a">
                <div class="ui-block-a"><span class="highlight">Latitude:</span></div>
                <div class="ui-block-b"><span id="latval">?</span></div>
            </div>

            <div class="ui-grid-a">
                <div class="ui-block-a"><span class="highlight">Longitude:</span></div>
                <div class="ui-block-b"><span id="lonval">?</span></div>
            </div>

            <br>
            <br>
            <p id="checkedLocation"> </p>
            <br>
            <br>
            <button id="relocate">Tarkista sijainti</button>
            
        </div>
        <div data-role="footer" data-position="fixed">
            <div class="ui-grid-a">
                <div class="ui-block-a">
                    <a href="#home" data-role="button" data-icon="home" data-iconpos="notext" data-theme="a" data-inline="true">Home</a>
                </div>
                <div class="ui-block-b">
                    <a href="#" data-role="button" data-rel="back" data-icon="back" data-iconpos="notext" data-theme="a" data-inline="true">Back</a>
                </div>
            </div>
        </div>
    </div>
    -->


    <!-- **** KÄYTTÖEHDOT **** -->
    <div data-role="page" id="termsofuse">
        <div data-role="header" data-position="fixed">
            <h1>Aarrejahti</h1>
        </div>
        <div data-role="content" class="content">

            <h2>Käyttöehdot</h2>

            <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse hendrerit, metus nec facilisis venenatis, nunc mauris scelerisque justo, in sodales massa nibh vel mauris. Nam sit amet libero at nulla rutrum porta. Etiam semper non sapien eu sollicitudin. Suspendisse a vehicula neque. In purus purus, accumsan ac magna non, mattis dictum est.
            </p>
            <p>
                Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Curabitur tristique massa felis, at congue quam vehicula sit amet. Phasellus molestie, felis id ultricies auctor, risus est scelerisque arcu, sit amet ornare odio felis eget tellus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. In fermentum, massa non auctor lacinia, felis elit posuere libero, vitae varius erat tellus tempus mi. Morbi at lectus at neque convallis tristique.
            </p>
            <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse hendrerit, metus nec facilisis venenatis, nunc mauris scelerisque justo, in sodales massa nibh vel mauris. Nam sit amet libero at nulla rutrum porta. Etiam semper non sapien eu sollicitudin. Suspendisse a vehicula neque. In purus purus, accumsan ac magna non, mattis dictum est.
            </p>
            <p>
                Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Curabitur tristique massa felis, at congue quam vehicula sit amet. Phasellus molestie, felis id ultricies auctor, risus est scelerisque arcu, sit amet ornare odio felis eget tellus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. In fermentum, massa non auctor lacinia, felis elit posuere libero, vitae varius erat tellus tempus mi. Morbi at lectus at neque convallis tristique.
            </p>
            
        </div>
        <div data-role="footer" data-position="fixed">
            <div class="ui-grid-a">
                <div class="ui-block-a">
                    <a href="#home" data-role="button" data-icon="home" data-iconpos="notext" data-theme="a" data-inline="true">Home</a>
                </div>
                <div class="ui-block-b">
                    <a href="#" data-role="button" data-rel="back" data-icon="back" data-iconpos="notext" data-theme="a" data-inline="true">Back</a>
                </div>
            </div>
        </div>
    </div>



    <!-- **** TIETOJA **** -->
    <div data-role="page" id="info">
        <div data-role="header" data-position="fixed">
            <h1>Aarrejahti</h1>
        </div>
        <div data-role="content" class="content">

            <h2>Tietoja</h2>    

            <p>
                Tänne tulisi jotain pientä informaatiota itse sovelluksesta. Esim. tekijä(t) jne... Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse hendrerit, metus nec facilisis venenatis, nunc mauris scelerisque justo, in sodales massa nibh vel mauris. Nam sit amet libero at nulla rutrum porta. Etiam semper non sapien eu sollicitudin.
            </p>
            <p>
                Suspendisse a vehicula neque. In purus purus, accumsan ac magna non, mattis dictum est. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Curabitur tristique massa felis, at congue quam vehicula sit amet.
            </p>
            
        </div>
        <div data-role="footer" data-position="fixed">
            <div class="ui-grid-a">
                <div class="ui-block-a">
                    <a href="#home" data-role="button" data-icon="home" data-iconpos="notext" data-theme="a" data-inline="true">Home</a>
                </div>
                <div class="ui-block-b">
                    <a href="#" data-role="button" data-rel="back" data-icon="back" data-iconpos="notext" data-theme="a" data-inline="true">Back</a>
                </div>
            </div>
        </div>
    </div>


 <script type="text/javascript">
    /*
    // 62.2427925
 	var treasureLat = 62.2427795;
    // 25.7591883
 	var treasureLon = 25.7592863;

    var checkBtn = document.getElementById('checkLocation');
	checkBtn.onclick = function(){
		var userLat = parseFloat(document.getElementById('latval').innerHTML);
		var userLon = parseFloat(document.getElementById('lonval').innerHTML);
		console.log(userLat);
		console.log(userLon);
		if ( ( (treasureLat - userLat <= 0.0009 ) && (treasureLat - userLat >= -0.0000) ) &&
			( (treasureLon - userLon <= 0.0009 ) && (treasureLon - userLon >= -0.0009) ) ) {
			document.getElementById('checkedLocation').innerHTML = 'Olet aivan aarteen lähellä!';
		}
        else if ( ( (treasureLat - userLat <= 0.002 ) && (treasureLat - userLat >= -0.002) ) &&
            ( (treasureLon - userLon <= 0.002 ) && (treasureLon - userLon >= -0.002) ) ) {
            document.getElementById('checkedLocation').innerHTML = 'Alkaa jo polttaa.';
        }
        else if ( ( (treasureLat - userLat <= 0.005 ) && (treasureLat - userLat >= -0.005) ) &&
            ( (treasureLon - userLon <= 0.005 ) && (treasureLon - userLon >= -0.005) ) ) {
            document.getElementById('checkedLocation').innerHTML = 'Lämpenee...';
        }
		else {
			document.getElementById('checkedLocation').innerHTML = 'Etsiskelehän vielä.';
		}
	}

    */
</script>

</div>
</body>
</html>